# Screen Time Analyzer

A Python tool to analyze Apple device (iPhone, iPad, Mac) usage time, bypassing the limitations of "Screen Time" data export.

## How It Works
Since Apple does not provide a direct API or export for Screen Time data, this project relies on **Shortcuts** that run periodically on your devices.
These shortcuts save a text file containing a list of apps and their cumulative daily usage time.
The files are manually exported in Markdown format.

The software:
1. Reads the log files generated by the shortcuts.
2. Parses the data (handling multiple formats and timestamps).
3. Saves raw data into a local SQLite database (`data/db/screentime.db`).
4. Calculates **usage intervals** by computing the difference between consecutive snapshots.
5. Archives the processed files.
6. Visualizes the data via an interactive **Streamlit Dashboard**.

## Project Structure

```
ScreenTimeAnalyzer/
â”œâ”€â”€ data/                    # Data folder (Ignored by Git for privacy)
â”‚   â”œâ”€â”€ [DeviceName]/        # Input folders (e.g., "iPhone", "iPad")
â”‚   â”œâ”€â”€ processed/           # Archive of processed files
â”‚   â””â”€â”€ db/                  # Contains the SQLite database (screentime.db)
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app.py               # Streamlit Dashboard Entry Point
â”‚   â”œâ”€â”€ main.py              # Main ingestion script
â”‚   â”œâ”€â”€ log_parser.py        # File parsing logic
â”‚   â”œâ”€â”€ processing.py        # Usage interval calculation
â”‚   â”œâ”€â”€ database.py          # DB schema and connection management
â”‚   â””â”€â”€ visualization/       # Visualization modules
â””â”€â”€ README.md
```

## Installation

1.  **Clone the repository:**
    ```bash
    git clone https://github.com/your-username/ScreenTimeAnalyzer.git
    cd ScreenTimeAnalyzer
    ```

2.  **Install dependencies:**
    ```bash
    pip install -r requirements.txt
    ```

## Usage

### 1. Shortcut Setup
To simplify the setup, you can directly download the shortcut used to export the data:
[Download iCloud Shortcut](https://www.icloud.com/shortcuts/a33e31659b2f4bd88005b953993ae0f4)

**Configuration Parameters:**
1.  **Note**: Specify the name of the Note where the data will be appended (e.g., "Activity iPhone 13 mini"). *Note: You will need to export this note to a markdown file for the tool to process.*
2.  **Filter (Optional)**: In the `If` block, you can set a threshold to ignore apps/websites with usage duration less than a certain value (e.g., 10 seconds).
3.  **Get App & Website Activity action**:
    -   **Device**: Select the specific device you want to track.
    -   **Type**: Set this to **"Apps & Websites"**.

### 2. Loading Data
Copy or sync the files generated by the shortcuts into subfolders in `data/`.
The name of the subfolder will be used as the **Device Name** in the database.
Example structure:
- `data/Activity iPhone/`
- `data/Activity iPad/`
- `data/Macbook/`

### 3. Running the Dashboard
The easiest way to use the tool is via the Dashboard:

```bash
streamlit run src/app.py
```

From the dashboard you can:
- **View Charts**: Weekly activity specific to device and year.
- **Update Data**: Click the **"ðŸ”„ Update Data"** button in the sidebar to ingest new files from the `data/` folder and update the database instantly.

### (Alternative) Manual Ingestion
You can also run the ingestion script manually via terminal:

```bash
python src/main.py
```

